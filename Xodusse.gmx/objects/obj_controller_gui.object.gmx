<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-50</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Screenshake variables
// © 2017 - Jon Harvey

globalvar Shake;
Shake = 0;
ShakeX = 0;
ShakeY = 0;
ShakeAngle = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///View and screenshake controller
// © 2017 - Jon Harvey

Shake = Shake*S90;
ShakeX = ShakeX*(1-S90)+S90*50*Shake*(random(2)-1);
ShakeY = ShakeY*(1-S90)+S90*50*Shake*(random(2)-1);
ShakeAngle = ShakeAngle*(1-S90)+S90*Shake*(random(40)-20);

if instance_exists(obj_player){
    
    //Smoothly translate and rotate view with the player.
    view_xview[0] = view_xview[0]*S90+(1-S90)*(obj_player.x-view_wview[0]/2+ShakeX+100*dsin(view_angle[0]));
    view_yview[0] = view_yview[0]*S90+(1-S90)*(obj_player.y-view_hview[0]/2+ShakeY-100*dcos(view_angle[0]));
    view_angle[0] = view_angle[0]*S90+(1-S90)*(90-obj_player.WalkDirection+ShakeAngle);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>PAUSED</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>false</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>422</id>
        <kind>1</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw GUI
// © 2017 - Jon Harvey

//Variables for view port width and height.
var S;
S = 64;

if instance_exists(obj_player){

    draw_set_font(FNT_EXUDATION);
    with(obj_player){
    
        //Inner circle.
        draw_set_alpha(0.6);
        //draw_circle_colour(0,GUIH,60,$222222,$333333,0);
        
        /*draw_primitive_begin(pr_trianglestrip);
        for(var i = 0;i&lt;=30;i++){            
            var Angle = i*3;
            draw_vertex_colour(dcos(Angle)*52,GUIH-dsin(Angle)*52,$999329,0.2);
            draw_vertex_colour(dcos(Angle),GUIH-dsin(Angle),$999329,0.2);
        }        
        draw_primitive_end();*/
        
        draw_set_alpha(1);
        
        //Outer reload circle.
        var Progress = min(Reload,1);
        if !Grenade{
        
            Progress = min(Reload/Greload[G[Current]],1);
        }
        
        draw_primitive_begin(pr_trianglestrip);
        for(var i = 0;i&lt;=30;i++){
            
            var Angle = i*3*Progress;
            draw_vertex_colour(dcos(Angle)*150,GUIH-dsin(Angle)*150,$D18214,0.3);
            draw_vertex_colour(dcos(Angle)*52,GUIH-dsin(Angle)*52,$999329,0.1);
        }
        draw_primitive_end();
        
        if Count{
            draw_set_colour($FFFFFF);           
            draw_set_font(FNT_EXUDATION_LARGE);
            draw_set_valign(fa_bottom);
            
            if !Grenade{
            
                //Gun info (magazine count, shots count in magazine, magazine capacity).
                draw_text_transformed(160,GUIH-40,string(max(Magazines,0)),1.5,1.5,0);
                draw_text_transformed(160,GUIH-8,string(Q[P[Current]])+"/"+string(Gcap[G[Current]]),1.5,1.5,0);
            }
            else{
            
                //Grenade info (grenade count).
                draw_text_transformed(160,GUIH-40,string(max(Q[P[Current]],0)),1.5,1.5,0);
            }
            
            draw_set_colour(0);
            draw_set_font(FNT_EXUDATION);
            draw_set_valign(fa_top);
            
            if  Current == Secondary{
                
                //Center gun on outer circle.
                var Item,Angle,Alpha;
                Item = I[P[Current]];
                Angle = 30*Swap-45;
                Alpha = 1;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,50/S,50/S,-Angle,-1,1);
                if (Item&lt;=Idoubles*2){
                    
                    draw_sprite_ext(spr_items,Item-2,dcos(Angle)*70,GUIH+dsin(Angle)*70,50/S,50/S,-Angle,-1,1);
                }
                
                //Top gun on outer circle.
                Item = I[P[(Current+1)%Count]];
                Angle = 30*Swap-75;
                Alpha = 0.5+Swap;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,40/S,40/S,-Angle,-1,Alpha);
                if (Item&lt;=Idoubles*2){
                    
                    draw_sprite_ext(spr_items,Item-2,dcos(Angle)*80,GUIH+dsin(Angle)*80,40/S,40/S,-Angle,-1,Alpha);
                }
                
                //Bottom gun on outer circle.
                Item = I[P[(Current-1+Count)%Count]];
                Angle = 30*Swap-15;
                Alpha = 0.5-Swap;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,40/S,40/S,-Angle,-1,Alpha);
                if (Item&lt;=Idoubles*2){
                    
                    draw_sprite_ext(spr_items,Item-2,dcos(Angle)*80,GUIH+dsin(Angle)*80,40/S,40/S,-Angle,-1,Alpha);
                }
            }
            else{
            
                //Center gun on outer circle.
                var Item,Angle,Alpha;
                Item = I[P[Current]];
                Angle = 30*Swap-45;
                Alpha = 1;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,50/S,50/S,-Angle,-1,1);
                
                Item = I[P[Secondary]];
                Angle = -45;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*70,GUIH+dsin(Angle)*70,50/S,50/S,-Angle,-1,1);
                
                //Top gun on outer circle.
                Item = I[P[(Current+1)%Count]];
                Angle = 30*Swap-75;
                Alpha = 0.5+Swap;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,40/S,40/S,-Angle,-1,Alpha);
                
                //Bottom gun on outer circle.
                Item = I[P[(Current-1+Count)%Count]];
                Angle = 30*Swap-15;
                Alpha = 0.5-Swap;
                draw_sprite_ext(spr_items,Item-1,dcos(Angle)*120,GUIH+dsin(Angle)*120,40/S,40/S,-Angle,-1,Alpha);
            }
        }

        
        //ROUND NUMBER:
        draw_set_colour($FFFFFF);
        
        draw_set_halign(fa_center);
        draw_set_valign(fa_middle);
        
        if (instance_exists(obj_controller_wave)) &amp;&amp; (room == rm_game_0){
            draw_set_font(fnt_Exudation_Large);
            draw_text_transformed(GUIW-60,GUIH-100,string(obj_controller_wave.WaveNumber),2,2,0);
            draw_set_font(fnt_Exudation);
            draw_text(GUIW-60,GUIH-60,"WAVE:");
        }
        
        draw_set_halign(fa_left);
        draw_set_valign(fa_top);        
        
        
        //Health bar:       
        draw_set_colour($999329);
               
        draw_rectangle(GUIW-100,GUIH-40,GUIW-100+clamp(Health,0,10)*8,GUIH-20,0);
        
        draw_set_colour($FFFFFF);

        draw_rectangle(GUIW-100,GUIH-40,GUIW-20,GUIH-20,1);         
        
        draw_set_colour(0);
    }
    
    //Inventory system.
    if Ienable{
          
        //Inventory base.
        draw_set_alpha(0.4);
        draw_rectangle(GUIW/2-S*3.5,GUIH/2-S*1.5-S*Ibackpack,GUIW/2+S*3.5,GUIH/2+S*1.5,0);
        
        //Backpack slot.
        draw_rectangle(GUIW/2+S*4.5,GUIH/2-S*1,GUIW/2+S*6.5,GUIH/2+S*1.5,0);
        draw_set_alpha(1);
        draw_set_colour($999329);
        draw_rectangle(GUIW/2+S*5,GUIH/2,GUIW/2+S*6,GUIH/2+S,1);
        
        //Weight and strength capacity
        draw_set_alpha(1);
        draw_set_colour($FFFFFF);
        draw_set_halign(fa_center);
        draw_set_valign(fa_middle);
        
        draw_text(GUIW/2+S*5.5,GUIH/2-S*0.5,string(ceil(Iweight))+"/"+string(Istrength)+" KG");
        
        draw_set_halign(fa_right);
        draw_set_valign(fa_bottom);
        draw_set_colour(0);
        
        if Ibackpack{
        
            draw_sprite(spr_items,Idoubles*2+Isingles+Igrenades+Iammo+Ibackpack-1,GUIW/2+S*5.5,GUIH/2+S*.5);
        }
        
        //Cycle through inventory items.
        for(var Y = 0;Y&lt;2+Ibackpack;Y++)
        for(var X = 0;X&lt;6;X++){
            
            var Item = I[X+Y*6];
            var Quantity = Q[X+Y*6];
            
            //Slot square.
            draw_set_colour($999329);
            draw_rectangle(GUIW/2-S*3+1+X*S,GUIH/2+1-Y*S,GUIW/2-S*2-1+X*S,GUIH/2+S-1-Y*S,1);
            draw_set_colour(0);
            
            if Item{
                
                //Item sprite.
                draw_sprite(spr_items,Item-1,GUIW/2-S*2.5+X*S,GUIH/2+S/2-Y*S);
                
                //Item quantity.
                if Quantity{
                    
                    draw_set_colour($FFFFFF);
                    draw_text(GUIW/2-S*2-2+X*S,GUIH/2+S-Y*S,Quantity);
                }
            }
        }
        
        //Item being moved.
        if Iid{
        
            var X,Y;
            X = window_mouse_get_x();
            Y = window_mouse_get_y();
            
            //Item sprite.
            draw_sprite(spr_items,Iid-1,X,Y);
            //Item's second part if it's a double.
            if Iid&lt;=Idoubles*2{
            
                draw_sprite(spr_items,Iid-2+2*(Iid%2),X-S+S*2*(Iid%2),Y);
            }
            //Item quantity.
            if Iquantity{
            
                draw_set_colour($FFFFFF);
                draw_text(X+S/2-2+S*(Iid&amp;1)*(Iid&lt;=Idoubles*2),Y+S/2,Iquantity);
            }
        }
        draw_set_colour(0);
        draw_set_halign(fa_left);
        draw_set_valign(fa_top);
    }
    draw_set_font(-1);
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>424</id>
        <kind>2</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>PAUSED</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>true</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>422</id>
        <kind>1</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw the pause screen.
//© 2017 - Reece Warren.

/* This needs to be drawn in a standard draw event because the button objects
   do not work whilst using Draw GUI, due to an alteration of the object's
   co-ordinates 
   */
   
draw_set_colour($000000);

//The final view_xview and view_yview co-ordinates that account for rotation.
var p1x,p1y,p2x,p2y,p3x,p3y,p4x,p4y;

    /*
       
        p1x,p1y   ---   p2x,p2y     ----
           |               |        vDist
       pH1x,pH1y   .   pH2x,pH2y    ----
           |               |           
        p3x,p3y   ---   p4x,p4y 
        
       
      * Firstly the horizontal relative camera points (pH1x,pH1y) &amp; (pH2x,pH2y) must be calculated from
        the center of the camera which is the rotation point:
             ( view_xview[0]+(view_wview[0]/2) )
             ( view_yview[0]+(view_hview[0]/2) )              
        
      * This is because the screen width and height are not considered to be a square ratio.
      
      * Next, the variable vDist is calculated, which determines the vertical component between the center rotation
        point and the top of the screen. (This is calculated by adding 90 degrees to the VIEW_ANGLE variable to account for
        the direction, and then this is multiplied by one half of the height of the view (view_hview[0]/2).
        
      * Lastly, this variable is then used to calculate the final positions of each point on the screen based upon
        the VIEW_ANGLE+90 direction, multiplied by the vDist, and either added or subtracted depending upon each unique
        co-ordinate.
        
      * NOTE:
        64px have also been added at either side to account for screen shake, when the edges overlap the visible
        view in the room. (This is the extender variable).   
      
    */

//Used in debugging:
/*
draw_circle(view_xview[0]+(view_wview[0]/2),view_yview[0]+(view_hview[0]/2),5,false);

draw_circle(pH1x,pH1y,5,false);
draw_circle(pH2x,pH2y,5,false);

draw_circle(p1x,p1y,5,false);
draw_circle(p2x,p2y,5,false);
draw_circle(p3x,p3y,5,false);
draw_circle(p4x,p4y,5,false);
*/    
    
var Extender = 64;
       
var pH1x = (view_xview[0]+(view_wview[0]/2))-(dcos(VIEW_ANGLE)*((view_wview[0]/2) + Extender));
var pH1y = (view_yview[0]+(view_hview[0]/2))-(dsin(VIEW_ANGLE)*((view_wview[0]/2) + Extender));

var pH2x = (view_xview[0]+(view_wview[0]/2))+(dcos(VIEW_ANGLE)*((view_wview[0]/2) + Extender));
var pH2y = (view_yview[0]+(view_hview[0]/2))+(dsin(VIEW_ANGLE)*((view_wview[0]/2) + Extender));

var vDist = point_distance(
            (view_xview[0]+(view_wview[0]/2))-(dcos(VIEW_ANGLE+90)*((view_hview[0]/2) + Extender)),
            (view_yview[0]+(view_hview[0]/2))-(dsin(VIEW_ANGLE+90)*((view_hview[0]/2) + Extender)),
            (view_xview[0]+(view_wview[0]/2)),
            (view_yview[0]+(view_hview[0]/2)));

var p1x = pH1x - (dcos(VIEW_ANGLE+90)*vDist);
var p1y = pH1y - (dsin(VIEW_ANGLE+90)*vDist);

var p2x = pH2x - (dcos(VIEW_ANGLE+90)*vDist);
var p2y = pH2y - (dsin(VIEW_ANGLE+90)*vDist);

var p3x = pH1x + (dcos(VIEW_ANGLE+90)*vDist);
var p3y = pH1y + (dsin(VIEW_ANGLE+90)*vDist);

var p4x = pH2x + (dcos(VIEW_ANGLE+90)*vDist);
var p4y = pH2y + (dsin(VIEW_ANGLE+90)*vDist);


//Draw the pause screen background:
draw_set_alpha(0.4);

draw_triangle(p1x,p1y,p2x,p2y,p3x,p3y,false);
draw_triangle(p2x,p2y,p3x,p3y,p4x,p4y,false);

//Reset the draw settings:
draw_set_colour($FFFFFF);
draw_set_alpha(1);

draw_set_font(fnt_Exudation_Large);
draw_set_halign(fa_center);
draw_set_valign(fa_middle);

//Draw menu items:
draw_text_transformed(
            (view_xview[0]+(view_wview[0]/2))-(dcos(VIEW_ANGLE+90)*128),
            (view_yview[0]+(view_hview[0]/2))-(dsin(VIEW_ANGLE+90)*128),
            "GAME PAUSED",
            1,1,VIEW_ANGLE*-1);

//Reset the draw settings:                      
draw_set_font(-1);
draw_set_halign(fa_left);
draw_set_valign(fa_top);  

draw_set_colour(-1);          
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>424</id>
        <kind>2</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
